- 여러개의 조건이 모두 참이어야 true가 되는 함수는 테스트하기가 힘들다. 이때는 하나라도 참이라면 true를 return하는 함수를 만들로 반대값을 return하면 된다.

# 복잡한 AND 조건 테스트 개선하기

## 문제점

여러 조건이 **모두 참**이어야 true가 되는 함수는 테스트하기 어렵습니다.

```typescript
// ❌ 테스트하기 어려운 AND 조건
function canAccessFeature(user: User): boolean {
  return user.age >= 18 && user.isActive && user.hasValidEmail && user.isPremium;
}
```

## 해결책: OR 조건으로 변경 후 반전

**드모르간 법칙**: `!(A && B && C) = !A || !B || !C`

```typescript
// ✅ 개선: 하나라도 참이면 true 반환하는 함수로 변경
function shouldExcludeFromFeature(user: User): boolean {
  const isUnderAge = user.age < 18;
  const isInactive = !user.isActive;
  const hasInvalidEmail = !user.hasValidEmail;
  const isNotPremium = !user.isPremium;

  return [
    isUnderAge, // 미성년자
    isInactive, // 비활성 사용자
    hasInvalidEmail, // 잘못된 이메일
    isNotPremium, // 프리미엄 아님
  ].some((condition) => condition);
}

function canAccessFeature(user: User): boolean {
  return !shouldExcludeFromFeature(user);
}
```

## 실제 사용 예시

```typescript
function shouldExcludeFromProcess(data: ProcessData): boolean {
  const isAlreadyProcessed = data.status === 'processed';
  const isInvalidType = data.type === 'invalid';
  const isExpired = data.expiryDate < new Date();
  const isLocked = data.isLocked;

  return [
    isAlreadyProcessed, // 이미 처리됨
    isInvalidType, // 잘못된 타입
    isExpired, // 만료됨
    isLocked, // 잠김 상태
  ].some((condition) => condition);
}
```

## 테스트 코드

```typescript
describe('shouldExcludeFromProcess', () => {
  it('should exclude when already processed', () => {
    const data = { status: 'processed', type: 'valid', expiryDate: new Date(), isLocked: false };

    expect(shouldExcludeFromProcess(data)).toBe(true);
  });

  it('should exclude when type is invalid', () => {
    const data = { status: 'pending', type: 'invalid', expiryDate: new Date(), isLocked: false };

    expect(shouldExcludeFromProcess(data)).toBe(true);
  });

  it('should not exclude when all conditions are false', () => {
    const data = { status: 'pending', type: 'valid', expiryDate: new Date(), isLocked: false };

    expect(shouldExcludeFromProcess(data)).toBe(false);
  });
});
```

## 장점

- ✅ **각 조건을 독립적으로 테스트** 가능
- ✅ **가독성 향상**: 제외 조건이 명확히 보임
- ✅ **유지보수 용이**: 새 조건 추가가 쉬움
